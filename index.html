<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Wriggle by tsigo</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Wriggle</h1>
<p>A simple Ruby directory crawler DSL</p>
        <p class="view"><a href="https://github.com/tsigo/wriggle">View the Project on GitHub <small>tsigo/wriggle</small></a></p>
        <ul>
          <li><a href="https://github.com/tsigo/wriggle/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/tsigo/wriggle/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/tsigo/wriggle">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>Usage</h2>

<div class="highlight">
<pre><span class="nb">require</span> <span class="s1">'wriggle'</span>

<span class="n">wriggle</span> <span class="s1">'/path/to/files'</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="o">|</span>
  <span class="c1"># Print a list of files</span>
  <span class="n">w</span><span class="o">.</span><span class="n">file</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">path</span> <span class="p">}</span>

  <span class="c1"># Build a list of Rails controller files</span>
  <span class="n">controllers</span> <span class="o">=</span> <span class="o">[]</span>
  <span class="n">w</span><span class="o">.</span><span class="n">files</span> <span class="sr">/_controller\.rb/</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span>
    <span class="n">controllers</span> <span class="o">&lt;&lt;</span> <span class="n">path</span>
  <span class="k">end</span>

  <span class="c1"># Print the path of any file named "spec_helper.rb"</span>
  <span class="n">w</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s1">'spec_helper.rb'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">path</span> <span class="p">}</span>

  <span class="c1"># Build an array of Ruby code files</span>
  <span class="n">ruby_files</span> <span class="o">=</span> <span class="o">[]</span>
  <span class="n">w</span><span class="o">.</span><span class="n">extension</span> <span class="ss">:rb</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span>
    <span class="n">ruby_files</span> <span class="o">&lt;&lt;</span> <span class="n">path</span>
  <span class="k">end</span>

  <span class="c1"># Build an array of video files</span>
  <span class="n">video_files</span> <span class="o">=</span> <span class="o">[]</span>
  <span class="n">w</span><span class="o">.</span><span class="n">extensions</span> <span class="sx">%w(mpg mpeg wmv avi mkv)</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span>
    <span class="n">video_files</span> <span class="o">&lt;&lt;</span> <span class="n">path</span>
  <span class="k">end</span>

  <span class="c1"># Delete directories that are empty</span>
  <span class="n">w</span><span class="o">.</span><span class="n">directories</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span>
    <span class="no">Dir</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">unless</span> <span class="no">Dir</span><span class="o">.</span><span class="n">entries</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">2</span>
  <span class="k">end</span>

  <span class="c1"># Print a list of directories matching "foo"</span>
  <span class="c1"># NOTE: Matches "/baz/bar/foo" and "/foo" but not "/foo/bar/baz"</span>
  <span class="n">w</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">path</span> <span class="p">}</span>
<span class="k">end</span>
</pre>
</div>


<h2>Caveats</h2>

<p>Wriggle is a wrapper around Ruby's standard library,
<a href="http://ruby-doc.org/stdlib/libdoc/find/rdoc/index.html">Find</a>. As such, it
crawls its starting path recursively. This is currently its default -- and only
-- behavior.</p>

<p>Defined blocks are yielded to as <code>Find</code> encounters a directory or file, <em>not
necessarily the order in which the blocks were defined</em>.</p>

<p>As an example, here is Wriggle crawling its own tree:</p>

<pre><code>ruby-1.9.2-p180 :001 &gt; require 'wriggle'
 =&gt; true
ruby-1.9.2-p180 :002 &gt; wriggle '.' do |w|
ruby-1.9.2-p180 :003 &gt;   w.file { |path| puts path }
ruby-1.9.2-p180 :004?&gt;   w.directory { |path| puts path }
ruby-1.9.2-p180 :005?&gt; end
.
./.document
./.gitignore
./.travis.yml
./Gemfile
./Gemfile.lock
./LICENSE
./README.md
./Rakefile
./lib
./lib/wriggle
./lib/wriggle/version.rb
./lib/wriggle.rb
./spec
./spec/spec_helper.rb
./spec/support
./spec/support/temporary_files.rb
./spec/wriggle_spec.rb
./wriggle.gemspec
</code></pre>

<p>If it were important to output a list of directories <em>and then</em> a list of
files, it might be best to collect each in their own arrays and then, outside
of the <code>wriggle</code> block, loop through them to print each entry.</p>

<h2>Install</h2>

<pre><code>gem install wriggle
</code></pre>

<h2>Documentation</h2>

<p><a href="http://rdoc.info/github/tsigo/wriggle/master/Wriggle">API Docs</a></p>

<h2>Contributing</h2>

<p>Pull requests and bug reports are very appreciated.</p>

<ul>
<li><a href="https://github.com/tsigo/wriggle/issues">Bug reports</a></li>
<li>Patches: Fork and send a pull request.

<ul>
<li>Include specs where it makes sense.</li>
</ul>
</li>
</ul><h3>Developer Quickstart</h3>

<p>Once you've cloned this repository or your own fork, these steps should
adequately prepare you to begin contributing to the project.</p>

<h4>Create a new RVM gemset (optional)</h4>

<pre><code>rvm gemset create wriggle
rvm gemset use wriggle
</code></pre>

<h4>Bundler</h4>

<p>First, <a href="https://github.com/carlhuda/bundler">install Bundler</a> if you haven't
already. Then install the development dependencies.</p>

<pre><code>bundle install
</code></pre>

<h4>Run Specs</h4>

<pre><code>rake spec
</code></pre>

<p>If everything passes, you're good to go!</p>

<h2>Copyright</h2>

<p>Copyright (c) 2011 Robert Speicher. See LICENSE for details.</p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/tsigo">tsigo</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>